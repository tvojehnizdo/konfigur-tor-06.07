const express=require('express'),cors=require('cors'),bodyParser=require('body-parser'),{GoogleSpreadsheet}=require('google-spreadsheet');require('dotenv').config();const app=express();app.use(cors());app.use(bodyParser.json());app.post('/api/save',async(req,res)=>{const doc=new GoogleSpreadsheet(process.env.SHEET_ID);await doc.useServiceAccountAuth({client_email:process.env.GOOGLE_CLIENT_EMAIL,private_key:process.env.GOOGLE_PRIVATE_KEY.replace(/\\n/g,'\n')});await doc.loadInfo();const sheet=doc.sheetsByIndex[0];await sheet.addRow(req.body);res.send('Saved!');});app.listen(3000,()=>console.log('Server running'));